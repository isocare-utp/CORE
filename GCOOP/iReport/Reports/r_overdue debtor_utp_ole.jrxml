<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="r_overdue debtor_utp" language="groovy" pageWidth="432" pageHeight="555" orientation="Landscape" columnWidth="432" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="4383880b-c322-43c7-a100-f935a3c66657">
	<property name="ireport.zoom" value="1.4641000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="as_period" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
DATEADD(d,-1, DATEADD(MONTH,DATEDIFF(MONTH,0,CONVERT(date,(concat(concat(substring($P{as_period},5,2), '/01/'),  substring($P{as_period},1,4)))))+1,0)) as d,
'ลูกหนี้ไม่ค้างชำระ' as loan,
count(lns.loancontract_no)  as count,
sum(lns.principal_balance) as principal_balance,
'0' as g
 from lnestloanshortlong  ln
left join lncontmaster lns  on ln.loancontract_no = lns.loancontract_no
where lns.last_periodpay >= 1 and lns.last_periodpay <=3
and ln.acc_year = $P{as_period}
union
select
DATEADD(d,-1, DATEADD(MONTH,DATEDIFF(MONTH,0,CONVERT(date,(concat(concat(substring('256509',5,2), '/01/'),  substring('256509',1,4)))))+1,0)) as d,
'ค้างชำระ 1 - 3 เดือน' as loan,
count(lns.loancontract_no)  as count,
sum(lns.principal_balance) as principal_balance,
'1' as g
 from lnestloanshortlong  ln
left join lncontmaster lns  on ln.loancontract_no = lns.loancontract_no
where lns.last_periodpay >= 1 and lns.last_periodpay <=3
and ln.acc_year = $P{as_period}
union
select
DATEADD(d,-1, DATEADD(MONTH,DATEDIFF(MONTH,0,CONVERT(date,(concat(concat(substring('256509',5,2), '/01/'),  substring('256509',1,4)))))+1,0)) as d,
 'ค้างชำระ 3 - 6 เดือน' as loan,
count(lns.loancontract_no)  as count,
sum(lns.principal_balance) as principal_balance,
'2' as g
 from lnestloanshortlong  ln
left join lncontmaster lns  on ln.loancontract_no = lns.loancontract_no
where lns.last_periodpay >3 and lns.last_periodpay <=6
and ln.acc_year = $P{as_period}
union
select
DATEADD(d,-1, DATEADD(MONTH,DATEDIFF(MONTH,0,CONVERT(date,(concat(concat(substring('256509',5,2), '/01/'),  substring('256509',1,4)))))+1,0)) as d,
'ค้างชำระ 6 - 12 เดือน'as loan,
count(lns.loancontract_no)  as count,
sum(lns.principal_balance) as principal_balance,
'3' as g
 from lnestloanshortlong  ln
left join lncontmaster lns  on ln.loancontract_no = lns.loancontract_no
where lns.last_periodpay >6 and lns.last_periodpay <=12
and ln.acc_year = $P{as_period}
union
select
DATEADD(d,-1, DATEADD(MONTH,DATEDIFF(MONTH,0,CONVERT(date,(concat(concat(substring('256509',5,2), '/01/'),  substring('256509',1,4)))))+1,0)) as d,
'ค้างชำระมากกว่า 12 เดือนขึ้นไป'as loan,
count(lns.loancontract_no)  as count,
sum(lns.principal_balance) as principal_balance,
'4' as g
 from lnestloanshortlong  ln
left join lncontmaster lns  on ln.loancontract_no = lns.loancontract_no
where lns.last_periodpay >12
and ln.acc_year = $P{as_period}
union
select
DATEADD(d,-1, DATEADD(MONTH,DATEDIFF(MONTH,0,CONVERT(date,(concat(concat(substring('256509',5,2), '/01/'),  substring('256509',1,4)))))+1,0)) as d,
'ลูกหนี้ตาย สาบสูญ เจ้าหนี้รายอื่นฟ้องล้มละลาย'as loan,
0 as count,
0 as principal_balance,
'5' as g
 from lnestloanshortlong  ln
left join lncontmaster lns  on ln.loancontract_no = lns.loancontract_no
union
select
DATEADD(d,-1, DATEADD(MONTH,DATEDIFF(MONTH,0,CONVERT(date,(concat(concat(substring('256509',5,2), '/01/'),  substring('256509',1,4)))))+1,0)) as d,
'หนี้ดำเนินคดีและหนี้ตามคำพิพากษา' as loan,
0 as count,
0 as principal_balance,
'6' as g
 from lnestloanshortlong  ln
left join lncontmaster lns  on ln.loancontract_no = lns.loancontract_no
order by g]]>
	</queryString>
	<field name="d" class="java.sql.Timestamp"/>
	<field name="loan" class="java.lang.String"/>
	<field name="count" class="java.lang.Integer"/>
	<field name="principal_balance" class="java.math.BigDecimal"/>
	<field name="g" class="java.lang.String"/>
	<variable name="sum_count" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{count}]]></variableExpression>
	</variable>
	<variable name="sum_principal_balance" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{principal_balance}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="20">
			<staticText>
				<reportElement uuid="aafe9ab8-d44f-4a6d-a5bc-189ef25471c2" x="0" y="0" width="426" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[รายงานสรุปลูลหนี้ค้างชำระ]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="40">
			<staticText>
				<reportElement uuid="003341d4-5f56-4400-b011-37823a39e83b" x="0" y="20" width="193" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[ประเภทลูลหนี้ (ลูกหน้ระยะสั้น + ระยะยาว)]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="84f02e03-a1e2-4ebe-b510-cd9429563209" x="193" y="20" width="64" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[จำนวน(ราย)]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="1f1357ac-d85e-418e-a04f-1b75fd9815fd" x="257" y="20" width="169" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[จำนวนเงิน(บาท)]]></text>
			</staticText>
			<textField>
				<reportElement uuid="dedafc29-516f-4c7d-8a39-923e943b01e7" x="193" y="0" width="233" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA["สิ้นสุดปีบัญชี ..ณ..." + $F{d}]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="20">
			<textField>
				<reportElement uuid="323389a9-8db1-4708-b9e9-58123bf1385e" x="193" y="0" width="64" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{count}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="9b1e573b-a82f-4f35-b142-07e37e68824e" x="257" y="0" width="169" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{principal_balance}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="db717e02-2e82-4fec-8a07-8f53ebf6f54e" x="0" y="0" width="193" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{loan}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="20" splitType="Stretch">
			<staticText>
				<reportElement uuid="20ff6be4-21f8-4182-aec3-7c512e1e780e" x="0" y="0" width="193" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[รวมทั้งหมด]]></text>
			</staticText>
			<textField>
				<reportElement uuid="7f069cf9-3b60-4d26-bab1-d968adfba7f9" x="193" y="0" width="64" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{sum_count}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="cb99a849-f4d1-42d4-90d6-efd91007c4de" x="257" y="0" width="169" height="20"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{sum_principal_balance}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
